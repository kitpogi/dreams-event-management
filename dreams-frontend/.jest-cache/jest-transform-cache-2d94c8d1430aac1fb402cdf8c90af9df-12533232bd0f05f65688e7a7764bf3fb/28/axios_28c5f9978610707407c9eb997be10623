c1e9bdd9a0e006b40f82d35fb0cda2b0
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;
var _axios = _interopRequireDefault(require("axios"));
function _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }
// Ensure API base URL is configured
const apiBaseURL = process.env.VITE_API_BASE_URL || 'http://localhost:8000/api';
if (!apiBaseURL) {
  console.warn('VITE_API_BASE_URL environment variable is not set. Using default: http://localhost:8000/api');
}
const api = _axios.default.create({
  baseURL: apiBaseURL,
  headers: {
    'Accept': 'application/json',
    'X-Requested-With': 'XMLHttpRequest'
  },
  withCredentials: true
});

// Request interceptor to add auth token
api.interceptors.request.use(config => {
  const token = localStorage.getItem('token');
  if (token) {
    config.headers.Authorization = `Bearer ${token}`;
  }
  return config;
}, error => {
  return Promise.reject(error);
});

// Response interceptor to handle errors
api.interceptors.response.use(response => response, error => {
  if (error.response?.status === 401) {
    localStorage.removeItem('token');
    localStorage.removeItem('user');

    // Only redirect to login if not already on a public route
    const currentPath = window.location.pathname;
    const publicRoutePatterns = [/^\/$/,
    // Home page
    /^\/login/,
    // Login page
    /^\/register/,
    // Register page
    /^\/packages(\/|$)/,
    // Packages pages (including /packages/:id)
    /^\/recommendations/ // Recommendations page
    ];
    const isPublicRoute = publicRoutePatterns.some(pattern => pattern.test(currentPath));
    if (!isPublicRoute) {
      window.location.href = '/login';
    }
  }
  return Promise.reject(error);
});
var _default = exports.default = api;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfYXhpb3MiLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwicmVxdWlyZSIsImUiLCJfX2VzTW9kdWxlIiwiZGVmYXVsdCIsImFwaUJhc2VVUkwiLCJwcm9jZXNzIiwiZW52IiwiVklURV9BUElfQkFTRV9VUkwiLCJjb25zb2xlIiwid2FybiIsImFwaSIsImF4aW9zIiwiY3JlYXRlIiwiYmFzZVVSTCIsImhlYWRlcnMiLCJ3aXRoQ3JlZGVudGlhbHMiLCJpbnRlcmNlcHRvcnMiLCJyZXF1ZXN0IiwidXNlIiwiY29uZmlnIiwidG9rZW4iLCJsb2NhbFN0b3JhZ2UiLCJnZXRJdGVtIiwiQXV0aG9yaXphdGlvbiIsImVycm9yIiwiUHJvbWlzZSIsInJlamVjdCIsInJlc3BvbnNlIiwic3RhdHVzIiwicmVtb3ZlSXRlbSIsImN1cnJlbnRQYXRoIiwid2luZG93IiwibG9jYXRpb24iLCJwYXRobmFtZSIsInB1YmxpY1JvdXRlUGF0dGVybnMiLCJpc1B1YmxpY1JvdXRlIiwic29tZSIsInBhdHRlcm4iLCJ0ZXN0IiwiaHJlZiIsIl9kZWZhdWx0IiwiZXhwb3J0cyJdLCJzb3VyY2VzIjpbImF4aW9zLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBheGlvcyBmcm9tICdheGlvcyc7XHJcblxyXG4vLyBFbnN1cmUgQVBJIGJhc2UgVVJMIGlzIGNvbmZpZ3VyZWRcclxuY29uc3QgYXBpQmFzZVVSTCA9IGltcG9ydC5tZXRhLmVudi5WSVRFX0FQSV9CQVNFX1VSTCB8fCAnaHR0cDovL2xvY2FsaG9zdDo4MDAwL2FwaSc7XHJcbmlmICghYXBpQmFzZVVSTCkge1xyXG4gIGNvbnNvbGUud2FybignVklURV9BUElfQkFTRV9VUkwgZW52aXJvbm1lbnQgdmFyaWFibGUgaXMgbm90IHNldC4gVXNpbmcgZGVmYXVsdDogaHR0cDovL2xvY2FsaG9zdDo4MDAwL2FwaScpO1xyXG59XHJcblxyXG5jb25zdCBhcGkgPSBheGlvcy5jcmVhdGUoe1xyXG4gIGJhc2VVUkw6IGFwaUJhc2VVUkwsXHJcbiAgaGVhZGVyczoge1xyXG4gICAgJ0FjY2VwdCc6ICdhcHBsaWNhdGlvbi9qc29uJyxcclxuICAgICdYLVJlcXVlc3RlZC1XaXRoJzogJ1hNTEh0dHBSZXF1ZXN0JyxcclxuICB9LFxyXG4gIHdpdGhDcmVkZW50aWFsczogdHJ1ZSxcclxufSk7XHJcblxyXG4vLyBSZXF1ZXN0IGludGVyY2VwdG9yIHRvIGFkZCBhdXRoIHRva2VuXHJcbmFwaS5pbnRlcmNlcHRvcnMucmVxdWVzdC51c2UoXHJcbiAgKGNvbmZpZykgPT4ge1xyXG4gICAgY29uc3QgdG9rZW4gPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgndG9rZW4nKTtcclxuICAgIGlmICh0b2tlbikge1xyXG4gICAgICBjb25maWcuaGVhZGVycy5BdXRob3JpemF0aW9uID0gYEJlYXJlciAke3Rva2VufWA7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gY29uZmlnO1xyXG4gIH0sXHJcbiAgKGVycm9yKSA9PiB7XHJcbiAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoZXJyb3IpO1xyXG4gIH1cclxuKTtcclxuXHJcbi8vIFJlc3BvbnNlIGludGVyY2VwdG9yIHRvIGhhbmRsZSBlcnJvcnNcclxuYXBpLmludGVyY2VwdG9ycy5yZXNwb25zZS51c2UoXHJcbiAgKHJlc3BvbnNlKSA9PiByZXNwb25zZSxcclxuICAoZXJyb3IpID0+IHtcclxuICAgIGlmIChlcnJvci5yZXNwb25zZT8uc3RhdHVzID09PSA0MDEpIHtcclxuICAgICAgbG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oJ3Rva2VuJyk7XHJcbiAgICAgIGxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKCd1c2VyJyk7XHJcbiAgICAgIFxyXG4gICAgICAvLyBPbmx5IHJlZGlyZWN0IHRvIGxvZ2luIGlmIG5vdCBhbHJlYWR5IG9uIGEgcHVibGljIHJvdXRlXHJcbiAgICAgIGNvbnN0IGN1cnJlbnRQYXRoID0gd2luZG93LmxvY2F0aW9uLnBhdGhuYW1lO1xyXG4gICAgICBjb25zdCBwdWJsaWNSb3V0ZVBhdHRlcm5zID0gW1xyXG4gICAgICAgIC9eXFwvJC8sICAgICAgICAgICAgICAgICAgICAvLyBIb21lIHBhZ2VcclxuICAgICAgICAvXlxcL2xvZ2luLywgICAgICAgICAgICAgICAgLy8gTG9naW4gcGFnZVxyXG4gICAgICAgIC9eXFwvcmVnaXN0ZXIvLCAgICAgICAgICAgICAvLyBSZWdpc3RlciBwYWdlXHJcbiAgICAgICAgL15cXC9wYWNrYWdlcyhcXC98JCkvLCAgICAgICAvLyBQYWNrYWdlcyBwYWdlcyAoaW5jbHVkaW5nIC9wYWNrYWdlcy86aWQpXHJcbiAgICAgICAgL15cXC9yZWNvbW1lbmRhdGlvbnMvLCAgICAgIC8vIFJlY29tbWVuZGF0aW9ucyBwYWdlXHJcbiAgICAgIF07XHJcbiAgICAgIFxyXG4gICAgICBjb25zdCBpc1B1YmxpY1JvdXRlID0gcHVibGljUm91dGVQYXR0ZXJucy5zb21lKHBhdHRlcm4gPT4gXHJcbiAgICAgICAgcGF0dGVybi50ZXN0KGN1cnJlbnRQYXRoKVxyXG4gICAgICApO1xyXG4gICAgICBcclxuICAgICAgaWYgKCFpc1B1YmxpY1JvdXRlKSB7XHJcbiAgICAgICAgd2luZG93LmxvY2F0aW9uLmhyZWYgPSAnL2xvZ2luJztcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGVycm9yKTtcclxuICB9XHJcbik7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBhcGk7XHJcblxyXG4iXSwibWFwcGluZ3MiOiI7Ozs7OztBQUFBLElBQUFBLE1BQUEsR0FBQUMsc0JBQUEsQ0FBQUMsT0FBQTtBQUEwQixTQUFBRCx1QkFBQUUsQ0FBQSxXQUFBQSxDQUFBLElBQUFBLENBQUEsQ0FBQUMsVUFBQSxHQUFBRCxDQUFBLEtBQUFFLE9BQUEsRUFBQUYsQ0FBQTtBQUUxQjtBQUNBLE1BQU1HLFVBQVUsR0FBR0MsT0FBQSxDQUFBQyxHQUFBLENBQWdCQyxpQkFBaUIsSUFBSSwyQkFBMkI7QUFDbkYsSUFBSSxDQUFDSCxVQUFVLEVBQUU7RUFDZkksT0FBTyxDQUFDQyxJQUFJLENBQUMsNkZBQTZGLENBQUM7QUFDN0c7QUFFQSxNQUFNQyxHQUFHLEdBQUdDLGNBQUssQ0FBQ0MsTUFBTSxDQUFDO0VBQ3ZCQyxPQUFPLEVBQUVULFVBQVU7RUFDbkJVLE9BQU8sRUFBRTtJQUNQLFFBQVEsRUFBRSxrQkFBa0I7SUFDNUIsa0JBQWtCLEVBQUU7RUFDdEIsQ0FBQztFQUNEQyxlQUFlLEVBQUU7QUFDbkIsQ0FBQyxDQUFDOztBQUVGO0FBQ0FMLEdBQUcsQ0FBQ00sWUFBWSxDQUFDQyxPQUFPLENBQUNDLEdBQUcsQ0FDekJDLE1BQU0sSUFBSztFQUNWLE1BQU1DLEtBQUssR0FBR0MsWUFBWSxDQUFDQyxPQUFPLENBQUMsT0FBTyxDQUFDO0VBQzNDLElBQUlGLEtBQUssRUFBRTtJQUNURCxNQUFNLENBQUNMLE9BQU8sQ0FBQ1MsYUFBYSxHQUFHLFVBQVVILEtBQUssRUFBRTtFQUNsRDtFQUNBLE9BQU9ELE1BQU07QUFDZixDQUFDLEVBQ0FLLEtBQUssSUFBSztFQUNULE9BQU9DLE9BQU8sQ0FBQ0MsTUFBTSxDQUFDRixLQUFLLENBQUM7QUFDOUIsQ0FDRixDQUFDOztBQUVEO0FBQ0FkLEdBQUcsQ0FBQ00sWUFBWSxDQUFDVyxRQUFRLENBQUNULEdBQUcsQ0FDMUJTLFFBQVEsSUFBS0EsUUFBUSxFQUNyQkgsS0FBSyxJQUFLO0VBQ1QsSUFBSUEsS0FBSyxDQUFDRyxRQUFRLEVBQUVDLE1BQU0sS0FBSyxHQUFHLEVBQUU7SUFDbENQLFlBQVksQ0FBQ1EsVUFBVSxDQUFDLE9BQU8sQ0FBQztJQUNoQ1IsWUFBWSxDQUFDUSxVQUFVLENBQUMsTUFBTSxDQUFDOztJQUUvQjtJQUNBLE1BQU1DLFdBQVcsR0FBR0MsTUFBTSxDQUFDQyxRQUFRLENBQUNDLFFBQVE7SUFDNUMsTUFBTUMsbUJBQW1CLEdBQUcsQ0FDMUIsTUFBTTtJQUFxQjtJQUMzQixVQUFVO0lBQWlCO0lBQzNCLGFBQWE7SUFBYztJQUMzQixtQkFBbUI7SUFBUTtJQUMzQixvQkFBb0IsQ0FBTztJQUFBLENBQzVCO0lBRUQsTUFBTUMsYUFBYSxHQUFHRCxtQkFBbUIsQ0FBQ0UsSUFBSSxDQUFDQyxPQUFPLElBQ3BEQSxPQUFPLENBQUNDLElBQUksQ0FBQ1IsV0FBVyxDQUMxQixDQUFDO0lBRUQsSUFBSSxDQUFDSyxhQUFhLEVBQUU7TUFDbEJKLE1BQU0sQ0FBQ0MsUUFBUSxDQUFDTyxJQUFJLEdBQUcsUUFBUTtJQUNqQztFQUNGO0VBQ0EsT0FBT2QsT0FBTyxDQUFDQyxNQUFNLENBQUNGLEtBQUssQ0FBQztBQUM5QixDQUNGLENBQUM7QUFBQyxJQUFBZ0IsUUFBQSxHQUFBQyxPQUFBLENBQUF0QyxPQUFBLEdBRWFPLEdBQUciLCJpZ25vcmVMaXN0IjpbXX0=