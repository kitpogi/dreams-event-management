{"version":3,"names":["_axios","_interopRequireDefault","require","e","__esModule","default","apiBaseURL","process","env","VITE_API_BASE_URL","console","warn","api","axios","create","baseURL","headers","withCredentials","interceptors","request","use","config","token","localStorage","getItem","Authorization","error","Promise","reject","response","status","removeItem","currentPath","window","location","pathname","publicRoutePatterns","isPublicRoute","some","pattern","test","href","_default","exports"],"sources":["axios.js"],"sourcesContent":["import axios from 'axios';\r\n\r\n// Ensure API base URL is configured\r\nconst apiBaseURL = import.meta.env.VITE_API_BASE_URL || 'http://localhost:8000/api';\r\nif (!apiBaseURL) {\r\n  console.warn('VITE_API_BASE_URL environment variable is not set. Using default: http://localhost:8000/api');\r\n}\r\n\r\nconst api = axios.create({\r\n  baseURL: apiBaseURL,\r\n  headers: {\r\n    'Accept': 'application/json',\r\n    'X-Requested-With': 'XMLHttpRequest',\r\n  },\r\n  withCredentials: true,\r\n});\r\n\r\n// Request interceptor to add auth token\r\napi.interceptors.request.use(\r\n  (config) => {\r\n    const token = localStorage.getItem('token');\r\n    if (token) {\r\n      config.headers.Authorization = `Bearer ${token}`;\r\n    }\r\n    return config;\r\n  },\r\n  (error) => {\r\n    return Promise.reject(error);\r\n  }\r\n);\r\n\r\n// Response interceptor to handle errors\r\napi.interceptors.response.use(\r\n  (response) => response,\r\n  (error) => {\r\n    if (error.response?.status === 401) {\r\n      localStorage.removeItem('token');\r\n      localStorage.removeItem('user');\r\n      \r\n      // Only redirect to login if not already on a public route\r\n      const currentPath = window.location.pathname;\r\n      const publicRoutePatterns = [\r\n        /^\\/$/,                    // Home page\r\n        /^\\/login/,                // Login page\r\n        /^\\/register/,             // Register page\r\n        /^\\/packages(\\/|$)/,       // Packages pages (including /packages/:id)\r\n        /^\\/recommendations/,      // Recommendations page\r\n      ];\r\n      \r\n      const isPublicRoute = publicRoutePatterns.some(pattern => \r\n        pattern.test(currentPath)\r\n      );\r\n      \r\n      if (!isPublicRoute) {\r\n        window.location.href = '/login';\r\n      }\r\n    }\r\n    return Promise.reject(error);\r\n  }\r\n);\r\n\r\nexport default api;\r\n\r\n"],"mappings":";;;;;;AAAA,IAAAA,MAAA,GAAAC,sBAAA,CAAAC,OAAA;AAA0B,SAAAD,uBAAAE,CAAA,WAAAA,CAAA,IAAAA,CAAA,CAAAC,UAAA,GAAAD,CAAA,KAAAE,OAAA,EAAAF,CAAA;AAE1B;AACA,MAAMG,UAAU,GAAGC,OAAA,CAAAC,GAAA,CAAgBC,iBAAiB,IAAI,2BAA2B;AACnF,IAAI,CAACH,UAAU,EAAE;EACfI,OAAO,CAACC,IAAI,CAAC,6FAA6F,CAAC;AAC7G;AAEA,MAAMC,GAAG,GAAGC,cAAK,CAACC,MAAM,CAAC;EACvBC,OAAO,EAAET,UAAU;EACnBU,OAAO,EAAE;IACP,QAAQ,EAAE,kBAAkB;IAC5B,kBAAkB,EAAE;EACtB,CAAC;EACDC,eAAe,EAAE;AACnB,CAAC,CAAC;;AAEF;AACAL,GAAG,CAACM,YAAY,CAACC,OAAO,CAACC,GAAG,CACzBC,MAAM,IAAK;EACV,MAAMC,KAAK,GAAGC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC;EAC3C,IAAIF,KAAK,EAAE;IACTD,MAAM,CAACL,OAAO,CAACS,aAAa,GAAG,UAAUH,KAAK,EAAE;EAClD;EACA,OAAOD,MAAM;AACf,CAAC,EACAK,KAAK,IAAK;EACT,OAAOC,OAAO,CAACC,MAAM,CAACF,KAAK,CAAC;AAC9B,CACF,CAAC;;AAED;AACAd,GAAG,CAACM,YAAY,CAACW,QAAQ,CAACT,GAAG,CAC1BS,QAAQ,IAAKA,QAAQ,EACrBH,KAAK,IAAK;EACT,IAAIA,KAAK,CAACG,QAAQ,EAAEC,MAAM,KAAK,GAAG,EAAE;IAClCP,YAAY,CAACQ,UAAU,CAAC,OAAO,CAAC;IAChCR,YAAY,CAACQ,UAAU,CAAC,MAAM,CAAC;;IAE/B;IACA,MAAMC,WAAW,GAAGC,MAAM,CAACC,QAAQ,CAACC,QAAQ;IAC5C,MAAMC,mBAAmB,GAAG,CAC1B,MAAM;IAAqB;IAC3B,UAAU;IAAiB;IAC3B,aAAa;IAAc;IAC3B,mBAAmB;IAAQ;IAC3B,oBAAoB,CAAO;IAAA,CAC5B;IAED,MAAMC,aAAa,GAAGD,mBAAmB,CAACE,IAAI,CAACC,OAAO,IACpDA,OAAO,CAACC,IAAI,CAACR,WAAW,CAC1B,CAAC;IAED,IAAI,CAACK,aAAa,EAAE;MAClBJ,MAAM,CAACC,QAAQ,CAACO,IAAI,GAAG,QAAQ;IACjC;EACF;EACA,OAAOd,OAAO,CAACC,MAAM,CAACF,KAAK,CAAC;AAC9B,CACF,CAAC;AAAC,IAAAgB,QAAA,GAAAC,OAAA,CAAAtC,OAAA,GAEaO,GAAG","ignoreList":[]}